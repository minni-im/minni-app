---
- name: minni-couchdb
  image: klaemo/couchdb
  ports: [ '5984:5984' ]
  volumes:
    - '/vagrant/logs/couchdb:/usr/local/var/log/couchdb'
    - '/vagrant/etc/couchdb:/usr/local/var/lib/couchdb'

- name: minni-redis
  image: redis
  ports: [ '6379:6379' ]
  volumes: [ '/vagrant/etc/redis:/data' ]

- name: minni-app
  image: node
  ports: [ '3000:3000' ]
  cmd: [ 'node', '/usr/local/www/index.js' ]
  links:
    - 'minni-redis:redis'
    - 'minni-couchdb:couchdb'
  volumes: [ '/vagrant:/usr/local/www' ]

- name: minni-nginx
  image: nginx
  ports: [ '8080:80' ]
  links: [ 'minni-app:app' ]
  volumes:
    - '/vagrant:/usr/local/var/www'
    - '/vagrant/logs:/var/log/nginx'
    - '/vagrant/etc/docker.nginx.conf:/etc/nginx/nginx.conf'
    - '/vagrant/etc/docker-nginx.conf.d:/etc/nginx/conf.d'
